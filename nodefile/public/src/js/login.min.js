(function(){var n=function(){var t=$(".person-id"),i=$(".person-pwd"),r=".btn-delete",u=".btn-edite",f=".btn-save",n=$(".person-list-message"),e="body";return{login:function(n){$("."+n).click(function(){var n=t.val(),r=i.val(),u;if(n==""||r==""){alert("请输入用户名和密码");return}u={name:n,password:r};$.ajax({url:$(".login-users").data("url"),type:"get",data:u,success:function(n){n.success?($("#personId").val(""),$("#personPwd").val(""),alert("登录成功")):($("#personId").val(""),$("#personPwd").val(""),alert("用户名或密码错误"))}})})},add:function(n){$("."+n).click(function(){var r=$(this),n=$("#newPersonId").val(),t=$("#newPersonPwd").val(),i;if(n==""||t==""){alert("请输入用户名和密码");return}i={name:n,password:t};$.ajax({url:$(".register-person").data("addurl"),type:"get",data:i,success:function(i){if(i.success){var r="<tr><td class='person-id'>"+n+"<\/td><td class='person-pwd'><input type='password' value="+t+" readonly='readonly'/><\/td>";r+='<td class="operate-btn"><span class="btn btn-delete">删除<\/span><span class="btn btn-edite">修改<\/span><span class="btn btn-save">保存<\/span><\/td><tr>';$(".person-list-message tr").last().after(r);$("#newPersonId").val("");$("#newPersonPwd").val("")}else alert("用户名重复"),$("#newPersonId").val(""),$("#newPersonPwd").val("")}})})},del:function(){n.on("click",r,function(){var n=$(this).parent().prevAll(".person-id").text(),t=$(this),i={name:n};$.ajax({url:$(".person-list").data("delurl"),post:"get",data:i,success:function(n){n.success?alert("删除失败"):t.parent().parent().remove()}})})},edite:function(){n.on("click",u,function(n){$(this).parent().prev().find("input").prop("readonly",!1).focus();$(this).parent().parent().siblings().find("input").prop("readonly",!0);n.stopPropagation()})},save:function(){n.on("click",f,function(){var n=$(this),t=$(this).parent().siblings(".person-id").text(),i=$(this).parent().siblings(".person-pwd").find("input").val(),r={name:t,password:i};$.ajax({url:$(".person-list").data("edite"),type:"get",data:r,success:function(t){t.success&&(alert("修改成功"),n.parent().prev().find("input").prop("readonly",!0))}})})},eStop:function(){$(e).click(function(){n.find(".list-pwd").prop("readonly",!0)})}}}();n.login("submit");n.add("add-person-btn");n.del();n.edite();n.save();n.eStop()})();